CREATE TABLE Brands (
    Id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Name NVARCHAR2(50) NOT NULL,
    Logo NVARCHAR2(2000),
    CONSTRAINT PK_Brands PRIMARY KEY (Id)
);

-- Create the Models table
CREATE TABLE Models (
    Id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Name NVARCHAR2(500) NOT NULL,
    Model_Year NUMBER NOT NULL,
    Fuel_Type NUMBER NOT NULL,
    Brand_Id NUMBER NOT NULL,
    CONSTRAINT PK_Models PRIMARY KEY (Id),
    CONSTRAINT FK_Models_Brands FOREIGN KEY (Brand_Id) REFERENCES Brands(Id)
);

-- Create the Users table
CREATE TABLE Users (
    Id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    First_Name NVARCHAR2(50) NOT NULL,
    Last_Name NVARCHAR2(50) NOT NULL,
    Email NVARCHAR2(230) NOT NULL,
    Birth_Date DATE,
    Registration_Date TIMESTAMP,
    CONSTRAINT PK_Users PRIMARY KEY (Id)
);

-- Create the UserVehicles table
CREATE TABLE User_Vehicles (
    User_Id NUMBER NOT NULL,
    Vehicle_Id NUMBER NOT NULL,
    CONSTRAINT PK_UserVehicles PRIMARY KEY (User_Id, Vehicle_Id),
    CONSTRAINT FK_UserVehicles_Users FOREIGN KEY (User_Id) REFERENCES Users(Id),
    CONSTRAINT FK_UserVehicles_Vehicles FOREIGN KEY (Vehicle_Id) REFERENCES Vehicles(Id)
);

-- Create the Vehicles table
CREATE TABLE Vehicles (
    ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    VIN CHAR(17) NOT NULL,
    License_Plate VARCHAR2(10),
    Registration_Date DATE,
    Exterior_Color VARCHAR2(50),
    Model_Id NUMBER NOT NULL,
    CONSTRAINT PK_Vehicles PRIMARY KEY (ID),
    CONSTRAINT FK_Vehicles_Models FOREIGN KEY (Model_Id) REFERENCES Models(Id)
);

-- Create the Driver_Licenses table
CREATE TABLE DRIVER_LICENSES 
(
  ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY INCREMENT BY 1 MAXVALUE 9999999999999999999999999999 MINVALUE 1 CACHE 20 NOT NULL 
, USER_ID NUMBER NOT NULL 
, ISSUED_DATE DATE NOT NULL 
, EXPIRATION_DATE DATE NOT NULL 
, CATEGORIES VARCHAR2(20 BYTE) NOT NULL 
, CONSTRAINT DRIVER_LICENSES_PK PRIMARY KEY)

ALTER TABLE DRIVER_LICENSES ADD CONSTRAINT chk_expiration_date CHECK (expiration_date = issued_date + INTERVAL '10' YEAR);
ALTER TABLE DRIVER_LICENSES ADD CONSTRAINT fk_user FOREIGN KEY (USER_ID) REFERENCES USERS (ID);
